#-----------------------------------------------------------------------------------------------------
# Copyright (c) 2005, Peter Sommerlad and IFS Institute for Software at HSR Rapperswil, Switzerland
# All rights reserved.
#
# This library/application is free software; you can redistribute and/or modify it under the terms of
# the license that is included with this library/application in the file license.txt.
#-----------------------------------------------------------------------------------------------------

{

	/RunOnly
	{
## --- all old ldap testcases: ---
#
#		"ldapNirvanaTestCfg"
#		"ldapWrongBindDNTestCfg"
#		"ldapWrongBindPWTestCfg"
#		"ldapDaImplEnvTestCfg"
#		"ldapSearchTestCfg"
#		"ldapExtendedSearchTestCfg"
#		"QueryCodedInConfiguration"
#		"QueryCodedInConfigurationSizeLimit"
#		"SearchForGivenService"
#		"EmptySearch"
#		"SearchForGivenServiceWithTimelimit"
#		"CompareSucceeds"
#		"CompareValue"
#		"ModifyValue"
#		"AddRemoveTest"
#		"ldapSearchThroughUserContainer"
#		"ldapSearchWithoutHTMLCharMapping"
#		"ldapSearchPlainBinaryValues"
#		"ldapSearchThroughServiceContainer"
#		"ldapSearchThroughClusterContainer"
#		"ldapDA_Ins_Query_Mod_Query_Del_Query"
#		"LDAPListMapperTest"
	}

	/RunTestCases
	{
		/ldapNirvanaTestCfg
		{
			/TheAction
			{
				/CallDA 	ldapNirvanaTestCfg
			}
			/ExpectedResult		0
			/Result
			{
				/TmpStore
				{
					/Mapper
					{
						/ErrorConnect
						{
							/Error
							{
								/Msg "Anonymous Bind: Can't connect to the LDAP server (91, ldapNirvanaTestCfg)"
								/Code 91
							}
						}
						/Error	"Anonymous Bind"
					}
				}
			}
		}
#		###############################################################################
		/ldapWrongBindDNTestCfg
		{
			/TheAction
			{
				/CallDA 	ldapWrongBindDNTestCfg
			}
			/ExpectedResult		0
			/Result
			{
				/TmpStore
				{
					/Mapper
					{
						/Error	"LDAPConnect"
						/ErrorConnect
						{
							/Error
							{
								/Msg "LDAPConnect: No such object (32, ldapWrongBindDNTestCfg)"
								/Code 32
							}
						}
					}
				}
			}
		}
#		###############################################################################
		/ldapWrongBindPWTestCfg
		{
			/TheAction
			{
				/CallDA 	ldapWrongBindPWTestCfg
			}
			/ExpectedResult		0
			/Result
			{
				/TmpStore
				{
					/Mapper
					{
						/Error	"LDAPConnect"
						/ErrorConnect
						{
							/Error
							{
								/Msg "LDAPConnect: Invalid credentials (49, ldapWrongBindPWTestCfg)"
								/Code 49
							}
						}
					}
				}
			}
		}
#		###############################################################################
		/ldapDaImplEnvTestCfg
		{
			/Env
			{
				/Base			"ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch"
				/Filter			"(&(objectclass=client)(uid=tkgae))"
				/Timeout		10
				/Attributes
				{
					"pd-dn"
					"language"
				}
				/SizeLimit		100
			}
			/TheAction
			{
				{ /CallDA ldapDaImplEnvTestCfg }
				{ /CallDA {
						ldapDaImplEnvTestCfg
						/Parameters
						{
							/Timeout	0
						}
					}
					}
			}
			/ExpectedResult		1
			/Result
			{
				/TmpStore
				{
					/Mapper
					{
						/LDAPResult
						{
							{
								/dn			"uid=tkgae,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch"
								/dnComponents
								{
									/uid		"tkgae"
									/ou			"tkfu"
									/o			"10601"
									/c			"CH"
									/dc			"tkfcd.hsr.ch"
								}
								/pd-dn		"cn=CH10601-tkgae,dc=tkfpd.hsr.ch"
								/language	"D"
							}
							{
								/dn			"uid=tkgae,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch"
								/dnComponents
								{
									/uid		"tkgae"
									/ou			"tkfu"
									/o			"10601"
									/c			"CH"
									/dc			"tkfcd.hsr.ch"
								}
								/pd-dn		"cn=CH10601-tkgae,dc=tkfpd.hsr.ch"
								/language	"D"
							}
						}
					}
				}
			}
		}
#		###############################################################################
		/ldapSearchTestCfg
		{
			/Env
			{
				/Base			"ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch"
				/userid			"tkgae"
				/Timeout		10
				/SizeLimit		100
			}
			/TheAction
			{
				{ /CallDA ldapSearchTestCfg }
				{ /CallDA {
						ldapSearchTestCfg
						/Parameters
						{
							/Timeout	0
						}
					}
					}
			}
			/ExpectedResult		1
			/Result
			{
				/TmpStore
				{
					/Mapper
					{
						/LDAPResult
						{
							{
								/dn			"uid=tkgae,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch"
								/uid		"tkgae"
							}
							{
								/dn			"uid=tkgae,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch"
								/uid		"tkgae"
							}
						}
					}
				}
			}
		}
#		###############################################################################
		/ldapExtendedSearchTestCfg
		{
			/Env
			{
				/userid			"tkgae"
				/objectclass1	client
				/Timeout		10
				/SizeLimit		100
			}
			/TheAction
			{
				{ /CallDA ldapSearchTest2Cfg }
				{ /CallDA {
						ldapSearchTest2Cfg
						/Parameters
						{
							/Timeout	0
						}
					}
					}
			}
			/ExpectedResult		1
			/Result
			{
				/TmpStore
				{
					/Mapper
					{
						/LDAPResult
						{
							{
								/dn			"uid=tkgae,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch"
								/pd-dn		"cn=CH10601-tkgae,dc=tkfpd.hsr.ch"
								/language	"D"
							}
							{
								/dn			"uid=tkgae,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch"
								/pd-dn		"cn=CH10601-tkgae,dc=tkfpd.hsr.ch"
								/language	"D"
							}
						}
					}
				}
			}
		}
#		###############################################################################
		/QueryCodedInConfiguration
		{
			/Query
			{
				/Base			"uid=tkgae,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch"
			}
			/TheAction
			{
				{ /CallDA ldapQueryCodedInConfiguration }
				{ /CallDA {
						ldapQueryCodedInConfiguration
						/Parameters
						{
							/Timeout	0
						}
					}
					}
			}
			/ExpectedResult		1
			/Result
			{
				/TmpStore
				{
					/Mapper
					{
						/LDAPResult
						{
							{
								/dn		"esid=10794/153.046.016.009,uid=tkgae,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch"
								/tc-dn	"tid=153.046.016.009,ou=tkftc,o=1,c=CH,dc=tkfcd.hsr.ch"
							}
							{
								/dn		"esid=10794/153.046.016.001,uid=tkgae,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch"
								/tc-dn	"tid=153.046.016.001,ou=tkftc,o=1,c=CH,dc=tkfcd.hsr.ch"
							}
							{
								/dn		"esid=10794/153.046.016.009,uid=tkgae,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch"
								/tc-dn	"tid=153.046.016.009,ou=tkftc,o=1,c=CH,dc=tkfcd.hsr.ch"
							}
							{
								/dn		"esid=10794/153.046.016.001,uid=tkgae,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch"
								/tc-dn	"tid=153.046.016.001,ou=tkftc,o=1,c=CH,dc=tkfcd.hsr.ch"
							}
						}
					}
				}
			}
		}
#		###############################################################################
		/QueryCodedInConfigurationSizeLimit
		{
			/Query
			{
				/Base			"uid=tkgae,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch"
				/SizeLimit		1
			}
			/TheAction
			{
				{ /ConditionalAction {
						/Call	{ /CallDA ldapQueryCodedInConfiguration }
						/False
						{
							{ /CallDA {
									ldapQueryCodedInConfiguration
									/Parameters
									{
										/Timeout	0
									}
								}
								}
						}
					}
					}
			}
			/ExpectedResult		0
			/Result
			{
				/TmpStore
				{
					/Mapper
					{
						/LDAPResult
						{
							{
								/dn		"esid=10794/153.046.016.009,uid=tkgae,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch"
								/tc-dn	"tid=153.046.016.009,ou=tkftc,o=1,c=CH,dc=tkfcd.hsr.ch"
							}
							{
								/Error
								{
									/Msg "LDAPSearch  Base[uid=tkgae,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch] Filter[(&(apptype=vdb)(objectclass=entitledservice))] Sizelimit exceeded"
									/Code 4
									/PartialMatch ""
								}
							}
							{
								/dn		"esid=10794/153.046.016.009,uid=tkgae,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch"
								/tc-dn	"tid=153.046.016.009,ou=tkftc,o=1,c=CH,dc=tkfcd.hsr.ch"
							}
							{
								/Error
								{
									/Msg "LDAPSearch  Base[uid=tkgae,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch] Filter[(&(apptype=vdb)(objectclass=entitledservice))] Sizelimit exceeded"
									/Code 4
									/PartialMatch ""
								}
							}
						}
					}
				}
			}
		}
#		###############################################################################
		/SearchForGivenService
		{
			/Env
			{
				/Base				"ou=tkftc,o=1,c=CH,dc=tkfcd.hsr.ch"
				/objectclass1		termcluster
				/transactiontype	dummy
				/appinstance		dummy
				/termclusterid		"172.016.000.165"
				/Timeout			10
				/SizeLimit			100
			}
			/TheAction
			{
				{ /CallDA SearchForGivenService }
			}
			/ExpectedResult		1
			/Result
			{
				/TmpStore
				{
					/Mapper
					{
						/LDAPResult
						{
							{
								/dn			"tid=172.016.000.165,ou=tkftc,o=1,c=CH,dc=tkfcd.hsr.ch"
								/appinst	dummy
								/tc-type	dummy
								/tid		"172.016.000.165"
							}
						}
					}
				}
			}
		}
#		###############################################################################
		/EmptySearch
		{
			/Env
			{
				/Base				"ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch"
				/Filter				"(&(objectclass=client)(uid=tkgaex))"			# uid not found
				/Attributes
				{
					pd-dn
					language
				}
				/Timeout			10
				/SizeLimit			100
			}
			/TheAction
			{
				{ /CallDA ldapEmptySearch }
				{ /CallDA {
						ldapEmptySearch
						/Parameters
						{
							/Timeout	0
						}
					}
					}
			}
			/ExpectedResult		1
			/Result
			{
				/TmpStore
				{
					/Mapper
					{
						/Info
						{
							/LdapSearchFoundEntryButNoData 1
						}
						/LDAPResult
						{
							""
						}
					}
				}
			}
		}
#		###############################################################################
		/SearchForGivenServiceWithTimelimit
		{
			/Query
			{
				/Base				"dc=tkfcd.hsr.ch"
				/termclusterid		"*"
				/Timeout			1
				/Scope				"subtree"
				/SizeLimit			10000
			}
			/TheAction
			{
				{ /CallDA TimeLimitExceededTest }
			}
			/ExpectedResult		0
			/Result
			{
				/TmpStore
				{
					/TimeLimitExceededTest
					{
						/Error "The request <LDAPSearch> took more then <1> seconds. "
					}
				}
			}
		}
#		###############################################################################
		/CompareSucceeds
		{
			/Query
			{
				/Compare		welcome
				/userid			CH10601-tkgoa
				/Input {
					/object1			client
					/object2			person
					/object3			tkfModify
					/TKFModTimeValue	"19990520_16:54:18"
					/Passwd				welcome
					/sn					"sn-test"
					/cn					"cn-test"
				}
				/Timeout		5
			}
			/Env
			{
				/FD_REMOTE_USER	"CH10601-tkgoa"
				/query
				{
					/Timeout	11
				}
			}
			/TheAction
			{
				{ /Call	{ /CallDA ldapAddTest } }
				{ /ConditionalAction {
						/Call	{ /CallDA ldapCompareTest }
						/True
						{
							{ /CallDA {
									ldapCompareTest
									/Parameters
									{
										/Timeout	0
									}
								}
								}
						}
					}
					}
				{ /Call	{ /CallDA ldapDelTest } }
			}
			/ExpectedResult		1
			/Result
			{
				/TmpStore
				{
					/Mapper
					{
						/LDAPResult
						{
							"LDAPAdd dn<uid=CH10601-tkgoa,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch>  was successfull"
							"LDAPCompare of Attribute userPassword of DN uid=CH10601-tkgoa,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch was successfull"
							"LDAPCompare of Attribute userPassword of DN uid=CH10601-tkgoa,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch was successfull"
							"LDAPDel dn<uid=CH10601-tkgoa,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch>  was successfull"
						}
					}
				}
			}
		}
#		###############################################################################
		/CompareValue
		{
			/TmpStore
			{
				/CompVar	hacc
			}
			/Query
			{
				/extendedsid		"11208/153.046.248.014"
				/userid				tkgae
				/organizationalunit	tkfu
				/organization		"10601"
				/country			ch
				/Timeout			10
			}
			/TheAction
			{
				{ /ConditionalAction {
						/Call	{ /CallDA ldapCompareTest1 }
						/True
						{
							{ /CallDA {
									ldapCompareTest1
									/Parameters
									{
										/Timeout	0
									}
								}
								}
						}
					}
					}
			}
			/ExpectedResult		1
			/Result
			{
				/TmpStore
				{
					/Mapper
					{
						/LDAPResult
						{
							"LDAPCompare of Attribute apptype of DN esid=11208/153.046.248.014,uid=tkgae,ou=tkfu,o=10601,c=ch,dc=tkfcd.hsr.ch was successfull"
							"LDAPCompare of Attribute apptype of DN esid=11208/153.046.248.014,uid=tkgae,ou=tkfu,o=10601,c=ch,dc=tkfcd.hsr.ch was successfull"
						}
					}
				}
			}
		}
#		###############################################################################
		/ModifyValue
		{
			/Query
			{
				/Input
				{
					/apptype		apptypeTest
					/stype			stypeTest
				}
				/Timeout		10
			}
			/TheAction
			{
				{ /ConditionalAction {
						/Call	{ /CallDA ldapModifyTest }
						/True
						{
							{ /CallDA {
									ldapModifyTest
									/Parameters
									{
										/Timeout	0
									}
								}
								}
						}
					}
					}
			}
			/ExpectedResult		1
			/Result
			{
				/TmpStore
				{
					/Mapper
					{
						/LDAPResult
						{
							"LDAPModify dn<esid=1100/172.016.200.013,uid=tkgae,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch>  was successfull"
							"LDAPModify dn<esid=1100/172.016.200.013,uid=tkgae,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch>  was successfull"
						}
					}
				}
			}
		}
#		###############################################################################
		/AddRemoveTest
		{
			/Query
			{
				/Input
				{
					/TKFModTimeValue		"19990520_16:54:18"
					/Passwd					welcome
					/UniversalId			userpassword
					/object1				client
					/object2				person
					/object3				tkfModify
					/sn						"sn-tkgoa"
					/cn						"cn-tkgoa"
				}
				/Timeout				11
			}
			/Env
			{
				/FD_REMOTE_USER	"CH10601-tkgoa"
			}
			/TheAction
			{
				{ /ConditionalAction {
						/Call
						{
							{ /ConditionalAction {
									/Call	{ /CallDA ldapAddTest }
									/True
									{
										{ /CallDA {
												ldapDelTest
												/Parameters
												{
													/Timeout	0
												}
											}
											}
									}
								}
								}
						}
						/True
						{
							{ /ConditionalAction {
									/Call
									{
										{ /CallDA {
												ldapAddTest
												/Parameters
												{
													/Timeout	0
												}
											}
											}
									}
									/True
									{
										{ /CallDA {
												ldapDelTest
												/Parameters
												{
													/Timeout	0
												}
											}
											}
									}
								}
								}
						}
					}
					}
			}
			/ExpectedResult		1
			/Result
			{
				/TmpStore
				{
					/Mapper
					{
						/LDAPResult
						{
							"LDAPAdd dn<uid=CH10601-tkgoa,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch>  was successfull"
							"LDAPDel dn<uid=CH10601-tkgoa,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch>  was successfull"
							"LDAPAdd dn<uid=CH10601-tkgoa,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch>  was successfull"
							"LDAPDel dn<uid=CH10601-tkgoa,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch>  was successfull"
						}
					}
				}
			}
		}
#		###############################################################################
		/ldapSearchThroughUserContainer
		{
			/TheAction
			{
				{ /ConditionalAction {
						/Call { /CallDA ldapDASearchC }
						/True
						{
							/Call { /CallDA ldapDASearchO }
							/True
							{
								/Call { /CallDA ldapDASearchOUuser }
								/True
								{
									/Call { /CallDA ldapDASearchUID }
									/True
									{
										{ /ConditionalAction {
												/Call	{ /CallDA ldapDASearchESID }
												/True
												{
													{ /ConditionalAction {
															/Call	{ /CallDA  ldapDASearchHEXID }
														}
														}
												}
											}
											}
									}
								}
							}
						}
					}
					}
			}
			/ExpectedResult		1
			/Result
			{
				/TmpStore
				{
					/Mapper
					{
						/LDAPResult
						{
							{
								/dn "c=CH,dc=tkfcd.hsr.ch"
								/c "CH"
								/description "SCHWEIZ"
							}
							{
								/dn "o=10601,c=CH,dc=tkfcd.hsr.ch"
								/o "10601"
								/ou "Institut fuer Software"
								/street "VEGA Help (&auml;&ouml;&uuml;י)"
							}
							{
								/dn "ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch"
								/ou "tkfu"
								/cn "ifs APPL. User Directory"
							}
							{
								/dn "uid=tkgae,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch"
								/uid "tkgae"
							}
							{
								/dn "esid=11072/153.046.248.014,uid=tkgae,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch"
								/esid "11072/153.046.248.014"
							}
							{
								/dn "esid=11204/153.046.248.014,uid=tkgae,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch"
								/esid "11204/153.046.248.014"
							}
							{
								/dn "esid=11205/153.046.248.014,uid=tkgae,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch"
								/esid "11205/153.046.248.014"
							}
							{
								/dn "esid=11206/153.046.248.014,uid=tkgae,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch"
								/esid "11206/153.046.248.014"
							}
							{
								/dn "esid=11207/153.046.248.014,uid=tkgae,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch"
								/esid "11207/153.046.248.014"
							}
							{
								/dn "esid=11208/153.046.248.014,uid=tkgae,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch"
								/esid "11208/153.046.248.014"
							}
							{
								/dn "esid=11209/153.046.248.014,uid=tkgae,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch"
								/esid "11209/153.046.248.014"
							}
							{
								/dn "hexid=0807E0,esid=99999/153.046.248.014,uid=tkgae,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch"
								/hexid "0807E0"
							}
						}
					}
				}
			}
		}
#		###############################################################################
		/ldapSearchWithoutHTMLCharMapping
		{
			/TheAction
			{
				/CallDA ldapDASearchONoMapping
			}
			/ExpectedResult		1
			/Result
			{
				/TmpStore
				{
					/Mapper
					{
						/LDAPResult
						{
							{
								/dn "o=10601,c=CH,dc=tkfcd.hsr.ch"
								/o "10601"
								/ou "Institut fuer Software"
								/street "VEGA Help (הצי)"
							}
						}
					}
				}
			}
		}
##########################################################################
        /ldapSearchPlainBinaryValues
		{
			/TheAction
			{
				/CallDA ldapDASearchOPlainBinary
			}
			/ExpectedResult		1
			/Result
			{
				/TmpStore
				{
					/Mapper
					{
						/LDAPResult
						{
							{
								/dn "o=10601,c=CH,dc=tkfcd.hsr.ch"
								/o "10601"
								/ou "Institut fuer Software"
								#/street "VEGA Help (הצי)" # see UTF-8 encoding below
								/street "VEGA Help (\xC3\xA4\xC3\xB6\xC3\xBC\xC3\xA9)"
							}
						}
					}
				}
			}
		}
#		###############################################################################
		/ldapSearchThroughServiceContainer
		{
			/TheAction
			{
				{ /ConditionalAction {
						/Call { /CallDA ldapDASearchOUcontainer }
						/True
						{
							{ /ConditionalAction {
									/Call { /CallDA ldapDASearchSID }
									/True
									{
										{ /ConditionalAction {
												/Call { /CallDA ldapDASearchPEID }
											}
											}
									}
								}
								}
						}
					}
					}
			}
			/ExpectedResult		1
			/Result
			{
				/TmpStore
				{
					/Mapper
					{
						/LDAPResult
						{
							{
								/dn "ou=tkfs,o=1,c=CH,dc=tkfcd.hsr.ch"
								/ou "tkfs"
							}
							{
								/dn "sid=11072,ou=tkfs,o=1,c=CH,dc=tkfcd.hsr.ch"
								/sid "11072"
							}
							{
								/dn "sid=11203,ou=tkfs,o=1,c=CH,dc=tkfcd.hsr.ch"
								/sid "11203"
							}
							{
								/dn "sid=11204,ou=tkfs,o=1,c=CH,dc=tkfcd.hsr.ch"
								/sid "11204"
							}
							{
								/dn "sid=11205,ou=tkfs,o=1,c=CH,dc=tkfcd.hsr.ch"
								/sid "11205"
							}
							{
								/dn "sid=11206,ou=tkfs,o=1,c=CH,dc=tkfcd.hsr.ch"
								/sid "11206"
							}
							{
								/dn "sid=11207,ou=tkfs,o=1,c=CH,dc=tkfcd.hsr.ch"
								/sid "11207"
							}
							{
								/dn "sid=11208,ou=tkfs,o=1,c=CH,dc=tkfcd.hsr.ch"
								/sid "11208"
							}
							{
								/dn "sid=11209,ou=tkfs,o=1,c=CH,dc=tkfcd.hsr.ch"
								/sid "11209"
							}
							{
								/dn "peid=003840000,sid=1100,ou=tkfs,o=1,c=CH,dc=tkfcd.hsr.ch"
								/peid "003840000"
							}
						}
					}
				}
			}
		}
#		###############################################################################
		/ldapSearchThroughClusterContainer
		{
			/TheAction
			{
				{ /ConditionalAction {
						/Call { /CallDA ldapDASearchOUcluster }
						/True
						{
							{ /ConditionalAction {
									/Call { /CallDA ldapDASearchOTID }
								}
								}
						}
					}
					}
			}
			/ExpectedResult		1
			/Result
			{
				/TmpStore
				{
					/Mapper
					{
						/LDAPResult
						{
							{
								/dn "ou=tkftc,o=1,c=CH,dc=tkfcd.hsr.ch"
								/ou "tkftc"
							}
							{
								/dn "tid=172.016.002.177,ou=tkftc,o=1,c=CH,dc=tkfcd.hsr.ch"
								/tid "172.016.002.177"
							}
							{
								/dn "tid=172.016.002.181,ou=tkftc,o=1,c=CH,dc=tkfcd.hsr.ch"
								/tid "172.016.002.181"
							}
						}
					}
				}
			}
		}
#		###############################################################################
		/ldapDA_Ins_Query_Mod_Query_Del_Query
		{
			/Query
			{
				/Compare				newpassword
				/Input
				{
					/object1			client
					/object2			person
					/object3			tkfModify
				}
				/Timeout		5
			}
			/TheAction
			{
				{ /CallDA ldapDAAddUserGAGA }
				{ /CallDA ldapDASearchUserGAGA }
				{ /ConditionalAction {
						/Call { /CallDA ldapDACompareUserGAGA  }
						/False
						{
							{ /CallDA ldapDAModifyUserGAGA }
							{ /CallDA ldapDASearchUserGAGA }
							{ /CallDA ldapDACompareUserGAGA  }
						}
					}
					}
				{ /CallDA ldapDADelUserGAGA }
			}
			/ExpectedResult		1
			/Result
			{
				/TmpStore
				{
					/Mapper
					{
						/LDAPResult
						{
							"LDAPAdd dn<uid=CH10601-tkgaga,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch>  was successfull"
							{
								/dn "uid=CH10601-tkgaga,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch"
								/uid "CH10601-tkgaga"
								/tkfmodtime "19990520_00:00:00"
								/userpassword "{SHA}i4USZkqMTjItSz1l6xGIxetN+9U="
							}
							"LDAPModify dn<uid=CH10601-tkgaga,ou=tkfu,o=10601,c=ch,dc=tkfcd.hsr.ch>  was successfull"
							{
								/dn "uid=CH10601-tkgaga,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch"
								/uid "CH10601-tkgaga"
								/tkfmodtime "19990520_00:11:22"
								/userpassword "{SHA}8sV4cDCNyH9DLlkS1N5vjjInIbo="
							}
							"LDAPCompare of Attribute userPassword of DN uid=CH10601-tkgaga,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch was successfull"
							"LDAPDel dn<uid=CH10601-tkgaga,ou=tkfu,o=10601,c=CH,dc=tkfcd.hsr.ch>  was successfull"
						}
					}
				}
			}
		}
		/LDAPListMapperTest
		{
			/TmpStore
			{
				/LdapIn1
				{
					/dn "aid=VDB,ou=tkfai,o=10601,c=CH,dc=tkfad.hsr.ch"
					/aid "VDB"
					/appkey "WVMktA8QWEQ="
					/tids
					{
						"153.046.016.001"
						"999.999.999.999"
					}
				}
				/LdapIn2
				{
					/dn "aid=VDBnixtc,ou=tkfai,o=10601,c=CH,dc=tkfad.hsr.ch"
					/aid "VDBnixtc"
					/appkey "WVMktA8QWEQ="
					/tids
					{
						"999.999.999.999"
						"998.998.998.998"
					}
				}
				/LdapIn3
				{
					/dn "aid=TXB,ou=tkfai,o=10601,c=CH,dc=tkfad.hsr.ch"
					/aid "TXB"
					/appkey "jHUdIfxKD3o="
					/tids
					{
						"153.046.016.001"
						"999.999.999.999"
					}
				}
			}
			/TheAction
			{
				/CallDA
				{
					/DataAccess ListMapperTestDA
				}
			}
			/ExpectedResult		1
			/Result
			{
				/TmpStore
				{
					/Mapper
					{
						/LdapOut
						{
							/VDB
							{
								/dn "aid=VDB,ou=tkfai,o=10601,c=CH,dc=tkfad.hsr.ch"
								/aid "VDB"
								/appkey "WVMktA8QWEQ="
								/tids
								{
									"153.046.016.001"
									"999.999.999.999"
								}
							}
							/VDBnixtc
							{
								/dn "aid=VDBnixtc,ou=tkfai,o=10601,c=CH,dc=tkfad.hsr.ch"
								/aid "VDBnixtc"
								/appkey "WVMktA8QWEQ="
								/tids
								{
									"999.999.999.999"
									"998.998.998.998"
								}
							}
							/TXB
							{
								/dn "aid=TXB,ou=tkfai,o=10601,c=CH,dc=tkfad.hsr.ch"
								/aid "TXB"
								/appkey "jHUdIfxKD3o="
								/tids
								{
									"153.046.016.001"
									"999.999.999.999"
								}
							}
						}
					}
				}
			}
		}
	}
}

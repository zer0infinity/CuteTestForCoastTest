#-----------------------------------------------------------------------------------------------------
# Copyright (c) 2005, Peter Sommerlad and IFS Institute for Software at HSR Rapperswil, Switzerland
# All rights reserved.
#
# This library/application is free software; you can redistribute and/or modify it under the terms of
# the license that is included with this library/application in the file license.txt.
#-----------------------------------------------------------------------------------------------------

{

	/TestReadMinimalInput
	{
		{
			/RequestLine "\r\n\r\n"
			/UriSizeLimit		271
			/LineSizeLimit		4096
			/RequestSizeLimit	5120
			/DoURLDecoding		1
			/URLEncodeExclude   "/?"
			/Expected
			{
				/FirstResponseLine	"HTTP/1.1 400 Bad Request"
				/Return			1
			}
		}
		{
			/RequestLine "GET  HTTP/1.0\r\n\r\n"
			/UriSizeLimit		271
			/LineSizeLimit		4096
			/RequestSizeLimit	5120
			/DoURLDecoding		1
			/URLEncodeExclude   "/?"
			/Expected
			{
				/REQUEST_METHOD	"GET"
				/Return			1
			}
		}
		{
			/RequestLine "GET  HTTP/1.0\r\n\r\n"
			/UriSizeLimit		8
			/LineSizeLimit		4096
			/RequestSizeLimit	5120
			/DoURLDecoding		1
			/URLEncodeExclude   "/?"
			/Expected
			{
				/FirstResponseLine	"HTTP/1.1 414 Request-URL Too Large"
				/Return			1
			}
		}
		{
			/RequestLine "GET  HTTP/1.0\r\n\r\n"
			/UriSizeLimit		271
			/LineSizeLimit		8
			/RequestSizeLimit	5120
			/DoURLDecoding		1
			/URLEncodeExclude   "/?"
			/Expected
			{
				/FirstResponseLine	"HTTP/1.1 413 Request Entity Too Large"
				/Return			0
			}
		}
		{
			/RequestLine "GET  HTTP/1.0\r\n\r\n"
			/UriSizeLimit		271
			/LineSizeLimit		4096
			/RequestSizeLimit	8
				/DoURLDecoding		1
				/URLEncodeExclude   "/?"
			/Expected
			{
				/FirstResponseLine	"HTTP/1.1 413 Request Entity Too Large"
				/Return			0
			}
		}
		{
			/RequestLine "xxGET  HTTP/1.0\r\n\r\n"
			/UriSizeLimit		271
			/LineSizeLimit		4096
			/RequestSizeLimit	5120
			/DoURLDecoding		1
			/URLEncodeExclude   "/?"
			/Expected
			{
				/FirstResponseLine "HTTP/1.1 405 Method Not Allowed"
				/Return			1
			}
		}
	}

	/TestCleanupRequestLine
	{
		# 0
		{
				/RequestLine 	"GET ?bar HTTP/1.0\r\n"
				/ExpectedRequest		"?bar"

				/HasErrors			 0
				/Reason				""
		}
		# 1
		{
				/RequestLine 	"GET / HTTP/1.0\r\n"
				/ExpectedRequest		"/"
				/HasErrors			 0
				/Reason				""
		}
		# 2
		{
				/RequestLine 	"GET %2F HTTP%2F1.0\r\n"
				/ExpectedRequest		"%2F"
				/HasErrors			 0
				/Reason				""
		}
		# 3
		{
				/RequestLine 	"GET /ftimage/image.gif HTTP/1.0\r\n"
				/ExpectedRequest		"/ftimage/image.gif"
				/HasErrors			 0
				/Reason				""
		}
		# 4
		{
				/RequestLine 	"GET %2Fftimage%2Fimage.gif HTTP%2F1.0\r\n"
				/ExpectedRequest		"%2Fftimage%2Fimage.gif"
				/WrongUrlArgsEncoding 0
				/HasErrors			 0
				/Reason				""
		}
		# 5
		# Above hex FF
		{
				/RequestLine 	"GET %2Fftimage%2F%u01FFimage.gif HTTP%2F1.0\r\n"
				/ExpectedRequest		""
				/HasErrors			1
				/Reason			"Encoded char above 0x255 detected"
		}
		# 6 # currently same as 5
		{
				/RequestLine 	"GET %2Fftimage%2F%u01FFimage.gif HTTP%2F1.0\r\n"
				/ExpectedRequest		""
				/HasErrors			1
				/Reason			"Encoded char above 0x255 detected"
		}
		# 7
		{
				/RequestLine 	"GET /ftimage/subimage/../../etc/shadow HTTP/1.0\r\n"
				/ExpectedRequest		 ""
				/HasErrors			 1
				/Reason				"Directory traversial attack"

		}
		# 8
		{
				/RequestLine 	"GET %u002Fftimage/subimage%u002F%u002E%u002E%u002F%2E%2E%2Fetc%2Fshadow HTTP/1.0\r\n"
				/ExpectedRequest		 ""
				/HasErrors			 1
				/Reason				"Directory traversial attack"
		}
		# 9
		{
				/RequestLine 	"GET %2Fftimage/subimage/%2E.%2F%2E%2E%2Fetc%2Fshadow HTTP/1.0\r\n"
				/ExpectedRequest		 ""
				/HasErrors			 1
				/Reason				"Directory traversial attack"
		}
		# 10
		{
				/RequestLine 	"GET /../../../../etc/shadow HTTP/1.0\r\n"
				/ExpectedRequest		 ""
				/HasErrors			 1
				/Reason				"Directory traversial attack"
		}
		# 11
		{
				/RequestLine 	"GET /ftimage/foo/..?fobaz&..&..&X HTTP/1.0\r\n"
				/ExpectedRequest		 ""
				/HasErrors			 1
				/Reason				"Directory traversial attack"
		}
		# 12
		{
				/RequestLine 	"GET %2Fftimage%2Ffoo%2F%2E%2E?fobaz&..&..&X HTTP/1.0\r\n"
				/ExpectedRequest		 ""
				/HasErrors			 1
				/Reason				"Directory traversial attack"
		}
		# 13
		# Arguments are not unescaped!
		{
				/RequestLine 	"GET %2Fftimage%2Ffoo?fobaz%2F%u002F&..&..&X HTTP/1.0\r\n"
				/ExpectedRequest		"%2Fftimage%2Ffoo?fobaz%2F%u002F&..&..&X"
				/HasErrors			 0
				/Reason				""
		}
		# 14
		# Request with terminating ? ( Must be removed, since a URI with terminating ? is not likely to be found )
		{
				/RequestLine 	"GET /kimdojo? HTTP/1.1\r\n"
				/ExpectedRequest		"/kimdojo"
				/HasErrors			 0
				/Reason				""
		}
		# 15
		{
				/RequestLine 	"GET %2Fkimdojo? HTTP/1.1\r\n"
				/ExpectedRequest		"%2Fkimdojo"
				/HasErrors			 0
				/Reason				""
		}
		# 16
		{
				/RequestLine 	"GET ? HTTP/1.1\r\n"
				/ExpectedRequest		""
				/HasErrors			 0
				/Reason				""
		}
		# 17
		{
				/RequestLine 	"GET /? HTTP/1.1\r\n"
				/ExpectedRequest		"/"
				/HasErrors			 0
				/Reason				""
		}
		# 18
		# Directory traversial cleanup, more elaborate cases
		{
				/RequestLine 	"GET /aa/bb/cc/dd/ee/ff/gg/hh/ii/fims-api-info/../../../../../etc/passwd HTTP/1.1\r\n"
				/ExpectedRequest		 ""
				/HasErrors			 1
				/Reason				"Directory traversial attack"
		}
		# 19
		{
				/RequestLine 	"GET /aa/bb/cc/dd/ee/ff/gg/hh/ii/fims-api-info/%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2fetc/passwd HTTP/1.1\r\n"
				/ExpectedRequest		 ""
				/HasErrors			 1
				/Reason				"Directory traversial attack"
		}
		# 20
		# Argument checking
		{
				/RequestLine 	"GET ?bar=%4B%69%6D-dojo& HTTP/1.0\r\n"
				/ExpectedRequest		"?bar=%4B%69%6D-dojo&"
				/HasErrors			 0
				/Reason				""
		}
		# 21
		{
				/RequestLine 	"GET /?bar=%4B%69%6D-dojo& HTTP/1.0\r\n"
				/ExpectedRequest		"/?bar=%4B%69%6D-dojo&"
				/HasErrors			 0
				/Reason				""
		}
		# 22
		{
				/RequestLine 	"GET %2F?bar=%4B%69%6D-!dojo& HTTP%2F1.0\r\n"
				/ExpectedRequest		"%2F?bar=%4B%69%6D-!dojo&"
				/HasErrors			 1
				/Reason				"Argument string (after ?) was not correctly encoded. Request not rejected."
		}
		# 23
		{
				/RequestLine 	"GET /ftimage/image.gif?bar=%4B%69%6D-dojo& HTTP/1.0\r\n"
				/ExpectedRequest		"/ftimage/image.gif?bar=%4B%69%6D-dojo&"
				/HasErrors			 0
				/Reason				""
		}
		# 24
		{
				/RequestLine 	"GET /ftimage/image.gif?bar=%u004B%u0069%u006D-dojo& HTTP/1.0\r\n"
				/ExpectedRequest		"/ftimage/image.gif?bar=%u004B%u0069%u006D-dojo&"
				/HasErrors			 0
				/Reason				""
		}
		# 25
		{
				/RequestLine 	"GET %2Fftimage%2Fimage.gif?bar=%4B%69%6D-dojo!& HTTP%2F1.0\r\n"
				/ExpectedRequest		"%2Fftimage%2Fimage.gif?bar=%4B%69%6D-dojo!&"
				/HasErrors			 1
				/Reason				"Argument string (after ?) was not correctly encoded. Request not rejected."
		}
		# 26
		# args above hex FF
		{
				/RequestLine 	"GET /ftimage/image.gif?bar=%u01FF-dojo& HTTP/1.0\r\n"
				/ExpectedRequest		"/ftimage/image.gif?bar=%u01FF-dojo&"
				/HasErrors			 0
				/Reason				""
		}
		# 27
		# Wrong path encodings, 4 cases basing on same url
		{
				/RequestLine 	"GET /ftimage!/image.gif HTTP/1.0\r\n"
				/ExpectedRequest		""
				/HasErrors			 1
				/Reason				"Not all unsave chars URL encoded"
		}
		# 28
		# Same, without url-decoding
		{
				/RequestLine 	"GET /ftimage!/image.gif HTTP/1.0\r\n"
				/ExpectedRequest		""
				/HasErrors			 1
				/Reason				"Not all unsave chars URL encoded"
		}
		# 29
		{
				/RequestLine 	"GET /ftimage%21/image.gif HTTP/1.0\r\n"
				/ExpectedRequest		"/ftimage%21/image.gif"
				/HasErrors			 0
				/Reason				""
		}
		# 30
		{
				/RequestLine 	"GET /ftimage%21/image.gif HTTP/1.0\r\n"
				/ExpectedRequest		"/ftimage%21/image.gif"
				/HasErrors			 0
				/Reason				""
		}
		# 31
		{
				/RequestLine 	"GET /ftimage/image.gif?bar=%u01FF-dojo& HTTP/1.0\r\n"
				/ExpectedRequest		"/ftimage/image.gif?bar=%u01FF-dojo&"
				/HasErrors			 0
				/Reason				""
		}
		# 32
		# Same, without url-decoding
		{
				/RequestLine 	"GET /ftimage%21/image.gif HTTP/1.0\r\n"
				/ExpectedRequest		"/ftimage%21/image.gif"
				/HasErrors			 0
				/Reason				""
		}
		# 33
		# not encoded blanks trigger end of path parsing
		{
				/RequestLine 	"GET /ftimage/image withblank.gif HTTP/1.0\r\n"
				/ExpectedRequest		"/ftimage/image"
				/HasErrors			 0
				/Reason				""
		}
		# 34
		{
				/RequestLine 	"GET /ftimage/image%20withblank.gif HTTP/1.0\r\n"
				/ExpectedRequest		"/ftimage/image%20withblank.gif"
				/HasErrors			 0
				/Reason				""
		}
		# 35
		# this does not correspond to the rfc, blank should be encoded
		{
				/RequestLine 	"GET /ftimage/image withblank.gif HTTP/1.0\r\n"
				/ExpectedRequest		"/ftimage/image"
				/HasErrors			 0
				/Reason				""
		}
		# 36
		# \ is not allowed
		{
				/RequestLine 	"GET /ftimage\image/my.gif HTTP/1.0\r\n"
				/ExpectedRequest		""
				/HasErrors			 1
				/Reason				"Not all unsave chars URL encoded"
		}
		# 37
		# after first pass of decoding there are still encoded sequences
		{
				/RequestLine 	"GET /ftimage%255Cimage/my.gif HTTP/1.0\r\n"
				/ExpectedRequest		""
				/HasErrors			 1
				/Reason				"Decoded URL path contains unsafe char"
		}
		# 38
		# %25%35%63 evaluates to \ which is not valid
		{
				/RequestLine 	"GET /ftimage%25%35%63../image/my.gif HTTP/1.0\r\n"
				/ExpectedRequest		""
				/HasErrors			 1
				/Reason				"Decoded URL path contains unsafe char"
		}

		# 39
		# after first pass of decoding there are still encoded sequences
		{
				/RequestLine 	"GET /ftimage%255C../ HTTP/1.0\r\n"
				/ExpectedRequest		""
				/HasErrors			 1
				/Reason				"Decoded URL path contains unsafe char"
		}

		# 40
		# %%35c evaluates to \
		{
				/RequestLine 	"GET /ftimage%%35c../image/my.gif HTTP/1.0\r\n"
				/ExpectedRequest		""
				/HasErrors			 1
				/Reason				"Decoded URL path contains unsafe char"
		}

		# 41
		# this are encoded chars > ascii 127, thus invalid
		{
				/RequestLine 	"GET /ftimage%C0%AF%C0%AF/image/my.gif HTTP/1.0\r\n"
				/ExpectedRequest		""
				/HasErrors			 1
				/Reason				"Decoded URL path contains unsafe char"
		}
		# 42
		# unicode encoded .. sequence
		{
				/RequestLine 	"GET /ftimage/%u002e%u002e/image/my.gif HTTP/1.0\r\n"
				/ExpectedRequest		""
				/HasErrors			 1
				/Reason				"Directory traversial attack"
		}
		# 43
		# %255C evaluates to \
		{
				/RequestLine 	"GET /ftimage%255C../image/my.gif HTTP/1.0\r\n"
				/ExpectedRequest		""
				/HasErrors			 1
				/Reason				"Decoded URL path contains unsafe char"
		}
		# 44
		# after one-time url decoding there are no more escaped squences, but invalid chars (same as 41)
		{
				/RequestLine 	"GET /ftimage%255C..%255C..%255C../image/my.gif HTTP/1.0\r\n"
				/ExpectedRequest		""
				/HasErrors			 1
				/Reason				"Decoded URL path contains unsafe char"
		}
		# 45 "old traversial attack tests"
		{
				/RequestLine 	"GET /ftimage/subimage/../../etc/shadow HTTP/1.0\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest		 "/etc/shadow"
				/HasErrors			 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 46
		{
				/RequestLine 	"GET %u002Fftimage/subimage%u002F%u002E%u002E%u002F%2E%2E%2Fetc%2Fshadow HTTP/1.0\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest		 "/etc/shadow"
				/HasErrors			 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 47
		{
				/RequestLine 	"GET %2Fftimage/subimage/%2E.%2F%2E%2E%2Fetc%2Fshadow HTTP/1.0\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest		 "/etc/shadow"
				/HasErrors			 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 48
		{
				/RequestLine 	"GET /ftimage/../../../etc/shadow HTTP/1.0\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest	 	"/etc/shadow"
				/HasErrors			 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 49
		{
				/RequestLine 	"GET %2Fftimage%2F%2E%2E%2F%2E%2E%2F%2E%2E%2Fetc%2Fshadow HTTP/1.0\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest	 	"/etc/shadow"
				/HasErrors			 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 50
		{
				/RequestLine 	"GET %2Fftimage%u002F%u002E%2E/%2E%2E%2F.%2E/etc%2Fshadow HTTP/1.0\r\n"
				/FixDirectoryTraversial		1
				/URLEncodeExclude   "/?"
				/ExpectedRequest	 	"/etc/shadow"
				/HasErrors			 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 51
		{
				/RequestLine 	"GET /../../../../etc/shadow HTTP/1.0\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest	 	"/etc/shadow"
				/HasErrors			 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 52
		{
				/RequestLine 	"GET %2F%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2Fetc%2Fshadow HTTP/1.0\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest	 	"/etc/shadow"
				/HasErrors			 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 53
		{
				/RequestLine 	"GET /ftimage/../../.. HTTP/1.0\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest		"/"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 54
		{
				/RequestLine 	"GET /ftimage%2F%2E%u002E%2F%2E%2E%2F%2E%2E HTTP/1.0\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest		"/"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 55
		{
				/RequestLine 	"GET /ftimage%2F%2E%2E%2F%2E%2E%2F%2E%2E HTTP/1.0\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest		"/"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 56
		{
				/RequestLine 	"GET /ftimage/../../../ HTTP/1.0\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest		"/"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 57
		{
				/RequestLine 	"GET /ftimage%2F%2E%u002E%2F%2E%2E%2F%u002E%2E%2F HTTP/1.0\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest		"/"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 58
		{
				/RequestLine 	"GET /. HTTP/1.0\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest		"/"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 59
		{
				/RequestLine 	"GET %2F%2E HTTP/1.0\r\n"
				/FixDirectoryTraversial		1
				/URLEncodeExclude   "/?"
				/ExpectedRequest		"/"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 60
		{
				/RequestLine	"GET /./. HTTP/1.0\r\n"
				/FixDirectoryTraversial		1
				/URLEncodeExclude   "/?"
				/ExpectedRequest		"/"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 61
		{
				/RequestLine	"GET %2F%2E%2F%2E HTTP/1.0\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest		"/"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 62
		{
				/RequestLine	"GET /ftimage/./ HTTP/1.0\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest		"/ftimage/"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 63
		{
				/RequestLine	"GET %2Fftimage%2F%2E%2F HTTP/1.0\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest		"/ftimage/"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 64
		{
				/RequestLine	"GET /ftimage/./. HTTP/1.0\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest		"/ftimage"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 65
		{
				/RequestLine	"GET %2Fftimage%2F%2E%2F%2E HTTP/1.0\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest		"/ftimage"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 66
		{
				/RequestLine	 "GET /ftimage/. HTTP/1.0\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest		"/ftimage"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 67
		{
				/RequestLine	 "GET %2Fftimage%2F%2E HTTP/1.0\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest		"/ftimage"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 68
		{
				/RequestLine 	"GET /ftimage/foo/..?fobaz&..&..&X HTTP/1.0\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest		"/ftimage?fobaz&..&..&X"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 69
		{
				/RequestLine 	"GET %2Fftimage%2Ffoo%2F%2E%2E?fobaz&..&..&X HTTP/1.0\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest		"/ftimage?fobaz&..&..&X"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# Arguments are not unescaped!
		# 70
		{
				/RequestLine 	"GET %2Fftimage%2Ffoo%2F%2E%2E?fobaz%2F%u002F&..&..&X HTTP/1.0\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest		"/ftimage?fobaz%2F%u002F&..&..&X"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# Directory traversial cleanup, more elaborate cases
		# 71
		{
				/RequestLine 	"GET /aa/bb/cc/dd/ee/ff/gg/hh/ii/fims-api-info/../../../../../etc/passwd HTTP/1.1\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest		"/aa/bb/cc/dd/ee/etc/passwd"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 72
		{
				/RequestLine 	"GET /aa/bb/cc/dd/ee/ff/gg/hh/ii/fims-api-info/%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2fetc/passwd HTTP/1.1\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest		"/aa/bb/cc/dd/ee/etc/passwd"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 73
		{
				/RequestLine 	"GET /../../../../../etc/passwd HTTP/1.1\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest		"/etc/passwd"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 74
		{
				/RequestLine 	"GET %2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2fetc/passwd HTTP/1.1\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest		"/etc/passwd"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 75
		{
				/RequestLine 	"GET ../../../../../etc/passwd HTTP/1.1\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest		"etc/passwd"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 76
		{
				/RequestLine 	"GET %2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2fetc/passwd HTTP/1.1\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest		"etc/passwd"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 77
		{
				/RequestLine 	"GET /etc%2f%2e%2fpasswd HTTP/1.1\r\n"
				/FixDirectoryTraversial		1
				/URLEncodeExclude   "/?"
				/ExpectedRequest		"/etc/passwd"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 78
		{
				/RequestLine 	"GET /etc/./././passwd HTTP/1.1\r\n"
				/FixDirectoryTraversial		1
				/URLEncodeExclude   "/?"
				/ExpectedRequest		"/etc/passwd"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 79
		{
				/RequestLine 	"GET /etc/./passwd HTTP/1.1\r\n"
				/FixDirectoryTraversial		1
				/URLEncodeExclude   "/?"
				/ExpectedRequest		"/etc/passwd"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 80
		{
				/RequestLine 	"GET /etc%2f%2e%2f%2f%2e%2f%2f%2e%2fpasswd HTTP/1.1\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest		"/etc/passwd"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 81
		{
				/RequestLine 	"GET ./etc/passwd HTTP/1.1\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest		"etc/passwd"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 82
		{
				/RequestLine 	"GET %2e%2fetc/passwd HTTP/1.1\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest		"etc/passwd"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 83
		{
				/RequestLine 	"GET %2e%2f%2e%2f%2e%2fetc/passwd HTTP/1.1\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest		"etc/passwd"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 84
		{
				/RequestLine 	"GET ./././etc/passwd HTTP/1.1\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest		"etc/passwd"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 85
		# Url with blank
		{
				/RequestLine 	"GET ./././etc/passwd/my%20blank.gif HTTP/1.1\r\n"
				/FixDirectoryTraversial		1
				/ExpectedRequest		"etc/passwd/my%20blank.gif"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 86
		# URLEncodeExclude set to ("/?=")
		{
				/RequestLine 	"GET ./././etc/passwd/my%3Dequals.gif HTTP/1.1\r\n"
				/URLEncodeExclude  "/?="
				/FixDirectoryTraversial		1
				/ExpectedRequest		"etc/passwd/my=equals.gif"
				/HasErrors 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 87
		#  multiple encodings.
		# after first pass of decoding there are still encoded sequences
		{
				/RequestLine 	"GET /ftimage%252Fimage/my.gif HTTP/1.0\r\n"
				/URLExhaustiveDecode	0
				/ExpectedRequest		""
				/HasErrors			 1
				/Reason				"Decoded URL path contains unsafe char"
		}
		# 88
		# multiple encodings. Only with FixDirectoryTraversial the modified request will be seen
		# and only if there had something to be fixed in the directory structure
		{
				/RequestLine 	"GET /ftimage%252F../image/my.gif HTTP/1.0\r\n"
				/URLExhaustiveDecode	1
				/FixDirectoryTraversial		1
				/ExpectedRequest		"/image/my.gif"
				/HasErrors			 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 89
		# multiple encodings.No FixDirectoryTraversial given
		{
				/RequestLine 	"GET /ftimage%252F../image/my.gif HTTP/1.0\r\n"
				/URLExhaustiveDecode	1
				/ExpectedRequest		""
				/HasErrors			 1
				/Reason				"Directory traversial attack"
		}
		# 90
		# %%%25%25%32%35%25%25%37%35002%%%u0075004%u0035 evaluates to a .
		{
				/RequestLine 	"GET /ftimage%252F.%%%25%25%32%35%25%25%37%35002%%%u0075004%u0035/image/my.gif HTTP/1.0\r\n"
				/URLExhaustiveDecode	1
				/FixDirectoryTraversial		1
				/ExpectedRequest		"/image/my.gif"
				/HasErrors			 1
				/Reason				"Directory traversial attack detected and normalized. Request not rejected because of config settings"
		}
		# 91
		# Char above hex 255  (unicode)
		{
				/RequestLine 	"GET /ftimage/%u0900/my.gif HTTP/1.0\r\n"
				/URLExhaustiveDecode	1
				/FixDirectoryTraversial		1
				/ExpectedRequest		""
				/HasErrors			 1
				/Reason				"Encoded char above 0x255 detected"
		}
		# 92
		# Normally we accept $-_.+/?% as unencoded chars in a URL
		# Now we allow = to be unencoded
		{
				/RequestLine 	"GET /ftimage/my=equals.gif HTTP/1.0\r\n"
				/CheckUrlEncodingOverride	"$-_.+/?%="
				/ExpectedRequest		"/ftimage/my=equals.gif"
				/HasErrors			 0
				/Reason				""
		}
		# 93
		# With the default $-_.+/?% the request is invalid
		{
				/RequestLine 	"GET /ftimage/my=equals.gif HTTP/1.0\r\n"
				/ExpectedRequest	""
				/HasErrors			 1
				/Reason				"Not all unsave chars URL encoded"
		}
		# 94
		# Not allowed chars in URL-path, default is "<>\"#%{}|\\^~[]`" ( after decoding )
		# x84=ä is extended ascii
		{
				/RequestLine 	"GET /ftimage/%u0084umlaut.gif HTTP/1.0\r\n"
				/ExpectedRequest	""
				/HasErrors			 1
				/Reason				"Decoded URL path contains unsafe char"
		}
		# 95
		# Now allow  0xe4=ä
		{
				/RequestLine 	"GET /ftimage/%u00e4umlaut.gif HTTP/1.0\r\n"
				/ExpectedRequest	"/ftimage/%u00e4umlaut.gif"
				/CheckUrlPathContainsUnsafeCharsAsciiOverride "ä"
				/HasErrors			 0
				/Reason				""
		}

		# 96
		# Override the default set of allowed chars in URL-path ( after decoding ) < = 0x3c
		# by removing it from the list
		{
				/RequestLine 	"GET /ftimage/%3csmaller.gif HTTP/1.0\r\n"
				/CheckUrlPathContainsUnsafeCharsOverride ">\"#%{}|\\^~[]`"
				/ExpectedRequest	"/ftimage/%3csmaller.gif"
				/HasErrors			 0
				/Reason				""
		}
	}
}
